---
title: "Internet Explorer: A Failure as a Browser, A Success as a Malware Analysis Tool"
date: 2024-09-02 10:00:00
classes: wide
header:
  teaser: /assets/images/Internet-Explorer-A-Failure-as-a-Browser-A-Success-as-a-Malware-Analysis-Tool/logo.png
  overlay_image: /assets/images/Internet-Explorer-A-Failure-as-a-Browser-A-Success-as-a-Malware-Analysis-Tool/logo.png
  overlay_filter: 0.5
ribbon: DarkSlateGray
excerpt: "Advanced JavaScript deobfuscation of Linux Web-Kit Exploit using Internet Explorer"
description: "Advanced JavaScript deobfuscation of Linux Web-Kit Exploit using Internet Explorer"
categories:
  - Malware
tags:
  - JS
  - Exploit kit
  - Windows
  - Ransomware
  - JS deobfuscation
  - Network traffic analysis
  - Web session analysis 
toc: true
toc_sticky: true
toc_label: "On This Blog"
toc_icon: "biohazard"
---
# Introduction

In this post, we will examine a malware infection delivered through a browser attack that implements an `Obfuscated JavaScript Exploit Kit` leading to the execution of `Ransomware`.
 
This is an excellent opportuniyty to explore various tactics, techniques and tools used to analyze such infections, helping you assess the potential impact of a similar attack on your organization.

To achive this, we will use the following tools: `Fiddler` as a `web proxy`, `Wireshark` to `monitor network traffic` and `Notepad++` alongside `Internet Explorer` to **deobfuscate the malicious JavaScript**... Yes, you read that right, `IE` as a **malware analysis tool**.

# Sample Details


|      Web Session Traffic          |                          |
|----------------|-------------------------------|
|File Name           |`Web-Session.saz`            |
|File Size           |`3085836 bytes`            |
|MD5          |`104bb64a9c4f6abbed67c0cc772744c6`|
|SHA256          |`26a1f2534305704194b50a71e38660e1794b84708cacf9f4622e30a4605f4661`|

-------------------------------

|      Network Traffic          |                          |
|----------------|-------------------------------|
|File Name           |`Web-Session.pcap`            |
|File Size           |`2574472 bytes`            |
|MD5          |`1b8c62edd6577c0a87333eddb4faa728`|
|SHA256          |`cd4cb335a14abd173255002ca6be60dadc8b2b82ab68832eff61b49f0390312b`|

-------------------------------

|      Exploit-Kit          |                          |
|----------------|-------------------------------|
|File Name           |`Exploit-kit.html`            |
|File Size           |`3533 bytes`            |
|MD5          |`6591755acbd7422e7d693ddc2a793442`|
|SHA256          |`27fb731a21cf1a7811aaeb06988742ae26651f17ecfee9b227f117209524ce01`|


# Web Traffic Analysis

After capturing the web session with `Fiddler` and navigating to the suspicious website, we can begin investigating its  requests and responses. 

In the first `200` response of `www.hiltongardeninnoakville.com`,  at the end of the response, there is a `script` tag where the variable `wcvius` is defined, which directly points to the URL where the malicious code is stored.

In additional, we can observe that the variable `bnryty`  contains `document.createElement("iframe");`. This code is used to create a hidden iframe within the infected page.

Furthermore, the line `document.body.appendChild(bnryty)` adds the iframe element to the rest of the webpage.

At the same time, the elemnt `bnryty.src =  wcvius;` load the malicious URL inside the iframe. 

![Untitled](/assets/images/Internet-Explorer-A-Failure-as-a-Browser-A-Success-as-a-Malware-Analysis-Tool/2.png)

# Network Traffic

# WebKit Exploit 

# JS deobfuscation 
